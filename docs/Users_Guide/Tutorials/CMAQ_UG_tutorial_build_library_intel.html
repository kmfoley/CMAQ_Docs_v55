
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Install netCDF-C &#8212; CMAQ_Documentation 0.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Users_Guide/Tutorials/CMAQ_UG_tutorial_build_library_intel';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">CMAQ_Documentation 0.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../README.html">
         User's Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="README.html">
         Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html">
         Developer's Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../README.html">
         User's Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="README.html">
         Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html">
         Developer's Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Install netCDF-C</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="install-netcdf-c">
<h1>Install netCDF-C<a class="headerlink" href="#install-netcdf-c" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Download netCDF-C from the following website https://www.unidata.ucar.edu/downloads/netcdf/index.jsp</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">unidata</span><span class="o">.</span><span class="n">ucar</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">4.7.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Untar the file</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="o">-</span><span class="n">xzvf</span> <span class="n">netcdf</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">4.7.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Change directories into the package</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">netcdf</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">4.7.0</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Verify that no modules are currently loaded using module commands.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="nb">list</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>See what modules are available on your compute server use the command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">avail</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Load module environment for a compiler (Intel|GCC|PGI) and mpi package corresponding to that compiler (e.g. openmpi).</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">intel18</span><span class="mf">.2</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">openmpi_3</span><span class="mf">.1.4</span><span class="o">/</span><span class="n">intel_18</span><span class="mf">.2</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Review the installation instructions for netcdf-c-4.7.0 for building netCDF</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">more</span> <span class="n">INSTALL</span><span class="o">.</span><span class="n">md</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Create a target installation directory that includes the loaded module environment name.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir $cwd/netcdf-c-4.7.0-intel18.2
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li><p>Run the configure –help command to see what settings can be used for the build.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Set the Compiler environment variables</p></li>
</ol>
<p>First find the path to the CC compiler on your system using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">icc</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to your CC compiler</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CC</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">icc</span>
</pre></div>
</div>
<p>Find the path to the Fortran compiler on your ssystem using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">ifort</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to the Fortran compiler on your system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">FC</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ifort</span>
</pre></div>
</div>
<p>Find the path to the CXX compiler on your system using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">icpc</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to the CXX compiler on your system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CXX</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">icpc</span>
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>Run the configure command</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./configure --prefix=$cwd/../netcdf --disable-dap
</pre></div>
</div>
<p>Building netCDF without the compression capabilities of netCDF4 can be done using the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./configure --prefix=$cwd/../netcdf --disable-netcdf-4 --disable-dap
</pre></div>
</div>
<p>This simpler installation can work for some applications, but the CMAQ ecosystem increasingly includes netCDF4 compression. For example, the cracmm1_aq 2018 benchmark and the MEGAN 3.2 preprocessor both require netCDF4. The error “Attempt to use feature that was not turned on when netCDF was built” suggests that your workflow requires netCDF4.</p>
<ol class="arabic simple" start="11">
<li><p>Check that the configure command worked correctly</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span> <span class="n">install</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">make</span><span class="o">.</span><span class="n">install</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<ol class="arabic simple" start="12">
<li><p>Verify that the following message is obtained at the end of your make.install.log.txt file</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>| Congratulations! You have successfully installed netCDF!    |
</pre></div>
</div>
</section>
<section id="install-netcdf-fortran">
<h1>Install netCDF-Fortran<a class="headerlink" href="#install-netcdf-fortran" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Download netCDF-Fortran from the following website https://www.unidata.ucar.edu/downloads/netcdf/index.jsp</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">unidata</span><span class="o">.</span><span class="n">ucar</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.4.5</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> 
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Untar the tar.gz file</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="o">-</span><span class="n">xzvf</span> <span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.4.5</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Change directories to netcdf-fortran-4.4.5</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.4.5</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Make an install directory that matches the name of your loaded module environment</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir $cwd/netcdf-fortran-4.4.5-intel18.2
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Review the installation document http://www.unidata.ucar.edu/software/netcdf/docs/building_netcdf_fortran.html</p></li>
<li><p>Set the environment variable NCDIR</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>setenv NCDIR $cwd/netcdf-c-4.7.0-intel18.2
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Set the CC environment variable to use the intel compilers</p></li>
</ol>
<p>First find the path to the CC compiler on your system using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">icc</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to your CC compiler</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CC</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">icc</span>
</pre></div>
</div>
<p>Find the path to the Fortran compiler on your ssystem using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">ifort</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to the Fortran compiler on your system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">FC</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ifort</span>
</pre></div>
</div>
<p>Find the path to the CXX compiler on your system using the which command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">icpc</span>
</pre></div>
</div>
<p>Next, replace the following path in the setenv command below to use the path to the CXX compiler on your system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CXX</span> <span class="o">/</span><span class="n">urs</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mf">18.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">icpc</span>
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li><p>Set your LD_LIBRARY_PATH to include the netcdf-C library path for netCDF build</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>setenv NCDIR /home/netcdf-c-4.7.0-intel18.2
setenv LD_LIBRARY_PATH ${NCDIR}/lib:${LD_LIBRARY_PATH}
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Check your LD_LIBRARY_PATH</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo $LD_LIBRARY_PATH
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>Set the install directory for netCDF fortran</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>setenv NFDIR /home/netcdf-fortran-4.4.5-intel18.2
setenv CPPFLAGS -I${NCDIR}/include
setenv LDFLAGS -L${NCDIR}/lib
</pre></div>
</div>
<ol class="arabic simple" start="11">
<li><p>check your LD_LIBRARY_PATH environment variable</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo $LD_LIBRARY_PATH
</pre></div>
</div>
<ol class="arabic simple" start="12">
<li><p>Run the configure command</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./configure --prefix=${NFDIR}
</pre></div>
</div>
<ol class="arabic simple" start="13">
<li><p>Run the make check command</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">check</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">make</span><span class="o">.</span><span class="n">check</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Output if successful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testsuite</span> <span class="n">summary</span> <span class="k">for</span> <span class="n">netCDF</span><span class="o">-</span><span class="n">Fortran</span> <span class="mf">4.4.5</span>
<span class="o">==========================================</span>
<span class="c1"># TOTAL: 6</span>
<span class="c1"># PASS:  6</span>
</pre></div>
</div>
<ol class="arabic simple" start="14">
<li><p>Run the make install command</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">install</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">make</span><span class="o">.</span><span class="n">install</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Output successful if you see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Libraries</span> <span class="n">have</span> <span class="n">been</span> <span class="n">installed</span> <span class="ow">in</span><span class="p">:</span>
   
   <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.4.5</span><span class="o">-</span><span class="n">intel18</span><span class="mf">.2</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">ever</span> <span class="n">happen</span> <span class="n">to</span> <span class="n">want</span> <span class="n">to</span> <span class="n">link</span> <span class="n">against</span> <span class="n">installed</span> <span class="n">libraries</span>
<span class="ow">in</span> <span class="n">a</span> <span class="n">given</span> <span class="n">directory</span><span class="p">,</span> <span class="n">LIBDIR</span><span class="p">,</span> <span class="n">you</span> <span class="n">must</span> <span class="n">either</span> <span class="n">use</span> <span class="n">libtool</span><span class="p">,</span> <span class="ow">and</span>
<span class="n">specify</span> <span class="n">the</span> <span class="n">full</span> <span class="n">pathname</span> <span class="n">of</span> <span class="n">the</span> <span class="n">library</span><span class="p">,</span> <span class="ow">or</span> <span class="n">use</span> <span class="n">the</span> <span class="s1">&#39;-LLIBDIR&#39;</span>
<span class="n">flag</span> <span class="n">during</span> <span class="n">linking</span> <span class="ow">and</span> <span class="n">do</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>
   <span class="o">-</span> <span class="n">add</span> <span class="n">LIBDIR</span> <span class="n">to</span> <span class="n">the</span> <span class="s1">&#39;LD_LIBRARY_PATH&#39;</span> <span class="n">environment</span> <span class="n">variable</span>
     <span class="n">during</span> <span class="n">execution</span>
   <span class="o">-</span> <span class="n">add</span> <span class="n">LIBDIR</span> <span class="n">to</span> <span class="n">the</span> <span class="s1">&#39;LD_RUN_PATH&#39;</span> <span class="n">environment</span> <span class="n">variable</span>
     <span class="n">during</span> <span class="n">linking</span>
   <span class="o">-</span> <span class="n">use</span> <span class="n">the</span> <span class="s1">&#39;-Wl,-rpath -Wl,LIBDIR&#39;</span> <span class="n">linker</span> <span class="n">flag</span>
   <span class="o">-</span> <span class="n">have</span> <span class="n">your</span> <span class="n">system</span> <span class="n">administrator</span> <span class="n">add</span> <span class="n">LIBDIR</span> <span class="n">to</span> <span class="s1">&#39;/etc/ld.so.conf&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="15">
<li><p>set your LD_LIBRARY_PATH to include the netcdf-Fortran library path for netCDF build</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>setenv NFDIR /home/netcdf-fortran-4.4.5-intel18.2
setenv LD_LIBRARY_PATH ${NFDIR}/lib:${LD_LIBRARY_PATH}
</pre></div>
</div>
<p>(may need to add the NCDIR and NFDIR to .cshrc)</p>
</section>
<section id="install-i-o-api">
<h1>Install I/O API<a class="headerlink" href="#install-i-o-api" title="Link to this heading">#</a></h1>
<p>Note The complete I/O API installation guide can be found at either of the following:</p>
<p>https://www.cmascenter.org/ioapi/documentation/all_versions/html/AVAIL.html</p>
<p>or</p>
<p>https://cjcoats.github.io/ioapi/AVAIL.html</p>
<ol class="arabic simple">
<li><p>Download I/O API</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/cjcoats/ioapi-3.2
cd ioapi-3.2         ! change directory to ioapi-3.2
git checkout -b 20200828   ! change branch to 20200828 for a tagged release version
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Change the BIN setting on line 133 of the Makefile to include the loaded module name</p></li>
</ol>
<p>cd ioapi
gedit Makefile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BIN</span>        <span class="o">=</span> <span class="n">Linux2_x86_64ifort_openmpi_3</span><span class="mf">.1.4</span><span class="n">_intel18</span><span class="mf">.2</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Change the NCFLIBS setting on line 141 of the Makefile to be</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NCFLIBS</span>    <span class="o">=</span> <span class="o">-</span><span class="n">lnetcdff</span> <span class="o">-</span><span class="n">lnetcdf</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Copy an existing Makeinclude file to have this BIN name at the end</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">ioapi</span>
<span class="n">cp</span> <span class="n">Makeinclude</span><span class="o">.</span><span class="n">Linux2_x86_64ifort</span> <span class="n">Makeinclude</span><span class="o">.</span><span class="n">Linux2_x86_64ifort_openmpi_3</span><span class="mf">.1.4</span><span class="n">_intel18</span><span class="mf">.2</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Edit the Makeinclude file, lines 27 and 28 to comment out the openmmp flag</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OMPFLAGS</span>  <span class="o">=</span> <span class="c1"># -qopenmp</span>
<span class="n">OMPLIBS</span>   <span class="o">=</span> <span class="c1"># -qopenmp</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Set the environment variable BIN</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">BIN</span> <span class="n">Linux2_x86_64ifort_openmpi_3</span><span class="mf">.1.4</span><span class="n">_intel18</span><span class="mf">.2</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Create a BIN directory under the ioapi-3.2 directory</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd ..
mkdir $BIN
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li><p>Create a link to this $BIN directory for WRF-CMAQ</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="n">Linux2_x86_64ifort_openmpi_3</span><span class="mf">.1.4</span><span class="n">_intel18</span><span class="mf">.2</span> <span class="n">Linux2_x86_64ifort</span>
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Link the netcdf-C and netcdf-Fortran library in the $BIN directory</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $BIN
ln -s /home/netcdf-c-4.7.0-intel18.2/libnetcdff.a
ln -s /home/netcdf-fortran-4.4.5-intel18.2/libnetcdf.a
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>Run the make command, specifying the location of the ioapi-3.2 directory path to compile and link the ioapi library</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">ioapi</span>
<span class="n">make</span> <span class="s1">&#39;HOME=[your_install_path]/LIBRARIES&#39;</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">make</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<ol class="arabic simple" start="11">
<li><p>Change directories to the $BIN dir and verify that both the libioapi.a and the m3tools were successfully built</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $BIN
ls -lrt libioapi.a
ls -rlt m3xtract
</pre></div>
</div>
<ol class="arabic simple" start="12">
<li><p>If you need to do a make clean, to rebuild the I/O API Library, specify the HOME directory at the command line as follows</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../</span><span class="n">ioapi</span>
<span class="n">make</span> <span class="s1">&#39;HOME=[your_install_path]/LIBRARIES&#39;</span> <span class="n">clean</span>


<span class="mf">13.</span> <span class="n">After</span> <span class="n">successfull</span> <span class="n">completion</span> <span class="n">of</span> <span class="n">this</span> <span class="n">tutorial</span><span class="p">,</span> <span class="n">the</span> <span class="n">user</span> <span class="ow">is</span> <span class="n">now</span> <span class="n">ready</span> <span class="n">to</span> <span class="n">proceed</span> <span class="n">to</span> <span class="n">the</span> <span class="p">[</span><span class="n">CMAQ</span> <span class="n">Installation</span> <span class="o">&amp;</span> <span class="n">Benchmarking</span> <span class="n">Tutorial</span><span class="p">](</span><span class="o">./</span><span class="n">CMAQ_UG_tutorial_benchmark</span><span class="o">.</span><span class="n">md</span><span class="p">)</span><span class="o">.</span> 

</pre></div>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Install netCDF-C</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#install-netcdf-fortran">Install netCDF-Fortran</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#install-i-o-api">Install I/O API</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/Users_Guide/Tutorials/CMAQ_UG_tutorial_build_library_intel.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, CMAQ Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>